description: "The [depth_image_proc](https://github.com/ros-perception/image_pipeline/tree/humble/depth_image_proc)\
  \ package computes a point cloud using a rectified depth image and a rectified color\
  \ image. \n"
graph: /imgs/a3_stereo_image_proc_graph.png
id: a4
name: a4_depth_image_proc
reproduction: "## ------- Installation -------\n# Create a ROS 2 overlay workspace\n\
  mkdir -p /tmp/benchmark_ws/src\n\n# Clone the benchmark repository\ncd /tmp/benchmark_ws/src\
  \ && git clone https://github.com/robotperf/benchmarks\n\n# Fetch dependencies\n\
  source /opt/ros/humble/setup.bash\ncd /tmp/benchmark_ws && sudo rosdep update ||\
  \ true && sudo apt-get update &&\n  sudo rosdep install --from-paths src --ignore-src\
  \ --rosdistro humble -y\n\n# Build the benchmark\ncolcon build --merge-install --packages-up-to\
  \ a4_depth_image_proc\n\n# Terminal 1: Replay rosbag in a loop (within rosbags repo)\n\
  cd /path/to/rosbags/perception\nros2 bag play --loop depth_image1\n\n# Verify you\
  \ are working in the workspace\ncd /tmp/benchmark_ws\n\n# Source the workspace as\
  \ an overlay\nsource install/setup.bash\n\n# Terminal 2: Run Stereo Image Proc Benchmark\n\
  ros2 launch a4_depth_image_proc trace_a4_depth_image_proc.launch.py\n\n# Verify\
  \ data was collected\ncd ~/.ros/tracing\nbabeltrace a4_depth_image_proc | less\n\
  \n# Analyze Data\nros2 launch a4_depth_image_proc analyze_a4_depth_image_proc.launch.py\n\
  \n# Optional: Visualize benchmark process while it's running using this script\n\
  chmod +x src/benchmarks/benchmarks/perception/a4_depth_image_proc/scripts/visualize_benchmark.sh\n\
  ./src/benchmarks/benchmarks/perception/a4_depth_image_proc/scripts/visualize_benchmark.sh\n\
  \n## ------- Reproduce Simulation -------\ncd /tmp/benchmark_ws\n\n# Source\nsource\
  \ install/setup.bash\n\n# Terminal 1: Launch Simulation\ncd /tmp/benchmark_ws \n\
  ros2 launch a4_depth_image_proc launch_sim.launch.py world:=src/benchmarks/benchmarks/perception/a4_depth_image_proc/worlds/parking_garage.world\n\
  \n# Terminal 2: Visualize perception from robot's perspective using rviz\nrviz2\
  \ -d src/benchmarks/benchmarks/perception/a4_depth_image_proc/config/sim_depth_camera_bot.rviz\n\
  \n# Terminal 3: Record a rosbag (ctrl+c to end recording)\nros2 bag record -a\n\n\
  # Terminal 4: Use keyboard to drive robot around world\nros2 run teleop_twist_keyboard\
  \ teleop_twist_keyboard\n\n# Verify: Play back rosbag after recording it in a loop\n\
  ros2 bag play --loop /path/to/bag/directory/\n"
results:
- result:
    category: edge
    datasource: perception/depth_image1
    hardware: 12th Gen Intel(R) Core(TM) i9-12900KF
    metric: latency
    metric_unit: ms
    note: 'Mean: 37.09 ms,  RMS: 65.12 ms, Max: 939.43 ms, Min: 7.97 ms over 1147
      samples.'
    timestampt: 26-04-2023
    type: grey
    value: 939.43
- result:
    category: edge
    datasource: perception/depth_image1
    hardware: NVIDIA AGX Orin Dev. Kit
    metric: power
    metric_unit: W
    note: ''
    timestampt: '2023-06-30 20:37:42'
    type: black
    value: 11.513117790222168
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: latency
    metric_unit: ms
    note: mean_benchmark 52.36187717005076, rms_benchmark 67.83441415522553, max_benchmark
      492.41293299999995, min_benchmark 15.982555999999999, lost messages 1.14 %
    timestampt: '2023-07-01 18:52:57'
    type: grey
    value: 492.41293299999995
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: power
    metric_unit: W
    note: ''
    timestampt: '2023-07-01 18:56:07'
    type: grey
    value: 10.32787799835205
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: throughput
    metric_unit: fps
    note: mean_benchmark 10.01179515336643, rms_benchmark 10.053770754687228, max_benchmark
      14.56166787712958, min_benchmark 1.401752375219967, lost messages 1.14 %
    timestampt: '2023-07-01 18:59:21'
    type: grey
    value: 14.56166787712958
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: latency
    metric_unit: ms
    note: mean_benchmark 24.904020833333334, rms_benchmark 25.9619138102967, max_benchmark
      56.589352000000005, min_benchmark 15.475099000000002, lost messages 0.00 %
    timestampt: '2023-07-01 19:02:52'
    type: grey
    value: 56.589352000000005
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: power
    metric_unit: W
    note: ''
    timestampt: '2023-07-01 19:06:20'
    type: grey
    value: 20.117462158203125
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: throughput
    metric_unit: fps
    note: mean_benchmark 30.164149180490657, rms_benchmark 30.17906066071334, max_benchmark
      34.984497844237744, min_benchmark 29.23188800258132, lost messages 0.00 %
    timestampt: '2023-07-01 19:09:30'
    type: grey
    value: 34.984497844237744
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: latency
    metric_unit: ms
    note: mean_benchmark 27.460619466666667, rms_benchmark 27.531410528435206, max_benchmark
      32.137471999999995, min_benchmark 23.952776, lost messages 0.00 %
    timestampt: '2023-07-01 19:12:48'
    type: black
    value: 32.137471999999995
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: power
    metric_unit: W
    note: ''
    timestampt: '2023-07-01 19:16:17'
    type: black
    value: 22.733518600463867
- result:
    category: workstation
    datasource: perception/image
    hardware: Intel i7-8700K
    metric: throughput
    metric_unit: fps
    note: mean_benchmark 30.002004606407837, rms_benchmark 30.016899528253816, max_benchmark
      32.56260364066182, min_benchmark 28.05284763755054, lost messages 0.00 %
    timestampt: '2023-07-01 19:20:02'
    type: black
    value: 32.56260364066182
short: Perception computational graph to compute a point cloud using a rectified depth
  image and a rectified color image.
